/*
 * Common include DTS file for CVM:P2888-0001 and CVB:P2822-0000 variants.
 *
 * Copyright (c) 2018-2020, NVIDIA CORPORATION.  All rights reserved.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; version 2 of the License.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for
 * more details.
 */

#define TEMP_ALERT TEGRA194_MAIN_GPIO(H, 2)

#include <dt-bindings/types.h>
#include "dt-bindings/extcon-ids.h"
#include <dt-bindings/regulator/regulator.h>
#include "dt-bindings/gpio/tegra194-gpio.h"
#include <dt-bindings/clock/tegra194-clock.h>
#include <dt-bindings/pwm/pwm.h>
#include <dt-bindings/interrupt-controller/arm-gic.h>
#include <dt-bindings/interrupt-controller/irq.h>
#include <dt-bindings/thermal/thermal.h>
#include <dt-bindings/thermal/nvidia,tegra-thermal-throttle.h>
#include "dt-bindings/input/input.h"
#include <dt-bindings/display/tegra-dc.h>
#include <dt-bindings/display/tegra-panel.h>
#include <dt-bindings/mfd/max77620.h>
#include <dt-bindings/sound/rt5659.h>

/dts-v1/;

/memreserve/ 0x80000000 0x00010000;

#include <tegra194-soc/tegra194-soc-base.dtsi>
#include <tegra194-soc/tegra194-cpus.dtsi>
#include <tegra194-soc/mods-simple-bus.dtsi>
#include <tegra194-soc/tegra194-soc-prod.dtsi>
#include <tegra194-soc/tegra194-soc-floor-sweeping.dtsi>

/ {

	model = "Jetson-AGX";
	compatible = "nvidia,tegra194";
	
	nvidia,dtsfilename = __FILE__;
	nvidia,dtbbuildtime = __DATE__, __TIME__;
	nvidia,fastboot-usb-vid = <0x0955>;
	nvidia,fastboot-usb-pid = <0xee1e>;
	model = "Jetson-AGX";
	compatible = "nvidia,galen", "nvidia,jetson-xavier", "nvidia,p2822-0000+p2888-0001", "nvidia,tegra194";

	#address-cells = <2>;
	#size-cells = <2>;

    aliases {
            rtc0 = &p2888_spmic;
            rtc1 = &tegra_rtc;
    };

	cpus {
		cpu@1 {
			status = "okay";
		};

		cpu@2 {
			status = "okay";
		};

		cpu@3 {
			status = "okay";
		};

		cpu@4 {
			status = "okay";
		};

		cpu@5 {
			status = "okay";
		};

		cpu@6 {
			status = "okay";
		};

		cpu@7 {
			status = "okay";
		};
	};

	L2_1: l2-cache1 {
		status = "okay";
	};

	L2_2: l2-cache2 {
		status = "okay";
	};

	L2_3: l2-cache3 {
		status = "okay";
	};

	/* L3 cache */
	tegra-cache {
		status = "okay";
	};
	
	tegra-carveouts {
		status = "okay";
	};

	clock@0 {
		status = "okay";
	};

	bpmp_reset@0 {
		status = "okay";
	};

	gv11b {
	    status = "okay";
	};

	dma@2600000 {
		status = "okay";
	};

	pinmux@2430000 {
		status = "okay";
	};

	gpio@2200000 {
		status = "okay";
		port-GG-interrupt-line = <0x0>;
	};

	gpio@c2f0000 {
		status = "okay";
	};

	efuse@3820000 {
		status = "okay";
		efuse-burn {
			status = "okay";
		};
	};

	kfuse@3830000 {
		status = "okay";
	};

	tegra194-pm-irq {
		status = "okay";
	};

	se_elp@3ad0000 {
		status = "okay";
	};

	rtc@c2a0000 {
		status = "okay";
	};

	tegra-cvnas {
		status = "okay";
	};

	mc {
		status = "okay";
	};

	mc_sid@2c00000 {
		status = "okay";
	};

	interrupt-controller@3881000 {
		status = "okay";
	};

	timer {
		status = "okay";
	};

	cbb-noc@2300000 {
		status = "okay";
	};

	aon-noc@C600000 {
		status = "okay";
	};

	bpmp-noc@D600000 {
		status = "okay";
	};

	rce-noc@BE00000 {
		status = "okay";
	};

	sce-noc@B600000 {
		status = "okay";
	};

	cv-noc@14040000 {
		status = "okay";
	};

	axi2apb@2390000 {
		status = "okay";
	};

	actmon@d230000 {
		status = "okay";
		mc_all {
			status = "okay";
		};
	};

	iommu@12000000 {
		status = "okay";
	};

	tegra-hsp@c150000 {
		status = "okay";
	};

	tegra-hsp@3c00000 {
		status = "okay";
	};
	
	psci {
		status = "okay";
	};

	cpufreq {
		status = "okay";
		cpufreq_single_policy;
	};

	arm64_ras {
		status = "okay";
	};

	carmel_ras {
		status = "okay";
	};

	host1x {
		se@15810000 {
			status = "okay";
		};

		se@15820000 {
			status = "okay";
		};

		se@15830000 {
			status = "okay";
		};

		se@15840000 {
			status = "okay";
		};
		
		ctx0 {
			status = "okay";
		};

		ctx1 {
			status = "okay";
		};

		ctx2 {
			status = "okay";
		};

		ctx3 {
			status = "okay";
		};

		ctx4 {
			status = "okay";
		};

		ctx5 {
			status = "okay";
		};

		ctx6 {
			status = "okay";
		};

		ctx7 {
			status = "okay";
		};
	};

	chosen {
		bootargs ="console=ttyTCU0,115200";
		board-has-eeprom;
	};
	
	eeprom-manager {
		status = "disabled";
		data-size = <0x100>;
		bus@0 {
			i2c-bus = <&gen1_i2c>;
			eeprom@0 {
				slave-address = <0x50>;
				label = "cvm";
			};
			eeprom@1 {
				slave-address = <0x56>;
			};
		};
	};
	
	clocks-init {
		compatible = "nvidia,clocks-config";
		status = "okay";
		disable {
			clocks = <&aon_clks TEGRA194_CLK_PLLAON>,
				<&bpmp_clks TEGRA194_CLK_CAN1>,
				<&bpmp_clks TEGRA194_CLK_CAN2>;
		};
	};

	dummy_cool_dev: dummy-cool-dev {
		compatible = "dummy-cooling-dev";
		#cooling-cells = <2>; /* min followed by max */
		status = "disabled";
	};

	external-connection {
		compatible = "simple-bus";
		device_type = "external-connection";
		#address-cells = <1>;
		#size-cells = <0>;
	};

	bpmp {
		status = "okay";
		bpmpthermal {
			status = "okay";
		};
	};

	arm-pmu {
		status = "okay";
	};

	power-domain {
		status = "disabled";
	};

	interrupt-controller {
		status = "disabled";
	};

	mods-simple-bus {
		status = "disabled";
	};

	cpuidle {
		compatible = "nvidia,tegra19x-cpuidle";
		status = "okay";
	};

	reserved-memory {
		vpr: vpr-carveout {
			compatible = "nvidia,vpr-carveout";
			size = <0 0x2a000000>;
			alignment = <0 0x400000>;
			alloc-ranges = <0x0 0x80000000 0x0 0x70000000>;
			reusable;
		};
		
		grid-of-semaphores {
			status = "okay";
		};
		
		ramoops_carveout {
			status = "okay";
		};
	};

	/* Power Management Controller */
	pmc@c360000 {
		status = "okay";
		iopad-defaults {
			sdmmc-io-pads {
				pins = "sdmmc1-hv", "sdmmc3-hv";
				nvidia,enable-voltage-switching;
			};
		};
	};

	pmc@c370000 {
		status = "okay";
		nvidia,invert-interrupt;
	};

	p2888_shuntv_offset: shuntv-offset {
		offset = <0>;
		conditional_offset@0 {
			shunt_volt_start = <0xFFFFFFD8>;
			shunt_volt_end = <0xFFFFFFD8>;
			offset = <40>;
		};
	};

	tegra-hsp@b950000 {
		status = "okay";
	};

	rtcpu@bc00000 {
		status = "okay";
		nvidia,cmd-timeout = <2000>;
	};

	hardwood {
		compatible = "nvidia,denver-hardwood";
		interrupts = <0 24 0x4>;
	};

	soft_wdt:soft_watchdog {
		compatible = "softdog-platform";
		status = "okay";
	};
	
	bthrot_cdev {
		compatible = "nvidia,tegra-thermal-throttle";
		clocks = <&bpmp_clks TEGRA194_CLK_NAFLL_CLUSTER0>,
				<&bpmp_clks TEGRA194_CLK_NAFLL_CLUSTER1>,
				<&bpmp_clks TEGRA194_CLK_NAFLL_CLUSTER2>,
				<&bpmp_clks TEGRA194_CLK_NAFLL_CLUSTER3>,
				<&bpmp_clks TEGRA194_CLK_NAFLL_GPU>;
		clock-names = "cpu0", "cpu1", "cpu2", "cpu3", "gpu";
		skin_balanced {
			cdev-type = "skin-balanced";
			#cooling-cells = <2>;
			nvidia,throttle-clocks = <TEGRA_THROTTLE_CPU 200 0
						TEGRA_THROTTLE_GPU 400 0>;
		};
		gpu_balanced {
			cdev-type = "gpu-balanced";
			#cooling-cells = <2>;
			nvidia,cutoff = <1>;
			nvidia,throttle-clocks = <TEGRA_THROTTLE_CPU 400 0
						TEGRA_THROTTLE_GPU 400 0>;
		};
		cpu_balanced {
			cdev-type = "cpu-balanced";
			#cooling-cells = <2>;
			nvidia,throttle-clocks = <TEGRA_THROTTLE_CPU 200 0
						TEGRA_THROTTLE_GPU 300 365500000>;
		};
		emergency_balanced {
			cdev-type = "emergency-balanced";
			#cooling-cells = <2>;
			nvidia,throttle-clocks = <TEGRA_THROTTLE_CPU 10 38400000
						TEGRA_THROTTLE_GPU 10 25500000>;
		};
		aux_balanced {
			cdev-type = "aux-balanced";
			#cooling-cells = <2>;
			nvidia,cutoff = <1>;
			nvidia,throttle-clocks = <TEGRA_THROTTLE_CPU 400 0
						TEGRA_THROTTLE_GPU 400 0>;
		};
	};
	
	thermal-zones {
		status = "disabled";

		Tboard_tegra: Tboard_tegra {
			status = "okay";
			polling-delay = <0>;
			polling-delay-passive = <1000>;
			thermal-sensors = <&tegra_tmp451 0>;
		};

		Tdiode_tegra: Tdiode_tegra {
			status = "okay";
			polling-delay = <0>;
			polling-delay-passive = <1000>;
			thermal-sensors = <&tegra_tmp451 1>;
		};
		
		CPU-therm {
			status = "okay";
			polling-delay-passive = <500>;

			thermal-zone-params {
				governor-name = "step_wise";
			};

			trips {
				trip_critical {
					temperature = <95500>;
					type = "critical";
					hysteresis = <0>;
					writable;
				};
				trip_bthrot {
					temperature = <90000>;
					type = "passive";
					hysteresis = <0>;
					writable;
				};
			};
			cooling-maps {
				map0 {
					trip = <&{/thermal-zones/CPU-therm/trips/trip_bthrot}>;
					cdev-type = "cpu-balanced";
					cooling-device = <&{/bthrot_cdev/cpu_balanced} THERMAL_NO_LIMIT THERMAL_NO_LIMIT>;
				};
			};
			
			trips {
				MAKE_EQOS_TRIP(m40, -40000, 5000);
				MAKE_EQOS_TRIP(m5, -5000, 5000);
				MAKE_EQOS_TRIP(p30, 30000, 5000);
				MAKE_EQOS_TRIP(p65, 65000, 5000);
				MAKE_EQOS_TRIP(p100, 100000, 5000);
			};

			cooling-maps {
				MAP_EQOS(m40, 1);
				MAP_EQOS(m5, 2);
				MAP_EQOS(p30, 3);
				MAP_EQOS(p65, 4);
				MAP_EQOS(p100, 5);
			};
			
		};

		AUX-therm {
			status = "okay";
			polling-delay-passive = <500>;
			trips {
				trip_critical {
					temperature = <94500>;
					type = "critical";
					hysteresis = <0>;
					writable;
				};

				trip_bthrot {
					temperature = <89000>;
					type = "passive";
					hysteresis = <0>;
					writable;
				};
			};
			cooling-maps {
				map0 {
					trip = <&{/thermal-zones/AUX-therm/trips/trip_bthrot}>;
					cdev-type = "aux-balanced";
					cooling-device = <&{/bthrot_cdev/aux_balanced} THERMAL_NO_LIMIT THERMAL_NO_LIMIT>;
				};
			};
		};

		GPU-therm {
			status = "okay";
			polling-delay-passive = <500>;

			thermal-zone-params {
				governor-name = "step_wise";
			};

			trips {
				trip_critical {
					temperature = <98000>;
					type = "critical";
					hysteresis = <0>;
					writable;
				};
				trip_bthrot {
					temperature = <92500>;
					type = "passive";
					hysteresis = <0>;
					writable;
				};
			};
			cooling-maps {
				map0 {
					trip = <&{/thermal-zones/GPU-therm/trips/trip_bthrot}>;
					cdev-type = "gpu-balanced";
					cooling-device = <&{/bthrot_cdev/gpu_balanced} THERMAL_NO_LIMIT THERMAL_NO_LIMIT>;
				};
			};

		};

		AO-therm {
			status = "okay";

			thermal-zone-params {
				governor-name = "step_wise";
			};

			trips {
				trip_dram_refresh {
					temperature = <85000>;
					type = "active";
					hysteresis = <3000>;
					writable;
				};
			};
			cooling-maps {
				map0 {
					trip = <&{/thermal-zones/AO-therm/trips/trip_dram_refresh}>;
					cdev-type = "bwmgr-therm-handler";
					cooling-device = <&bwmgr THERMAL_NO_LIMIT THERMAL_NO_LIMIT>;
				};
			};
		};
		
		PMIC-Die {
			polling-delay = <0>; /* milliseconds */
			polling-delay-passive = <0>; /* milliseconds */

			thermal-sensors = <&p2888_spmic>;
			trips {
				die_temp_thresh: hot-die {
					temperature = <120000>;
					type = "active";
					hysteresis = <0>;
				};
			};

			cooling-maps {
				map0 {
					trip = <&die_temp_thresh>;
					cooling-device = <&{/bthrot_cdev/emergency_balanced}
							THERMAL_NO_LIMIT THERMAL_NO_LIMIT>;
					contribution = <100>;
					cdev-type = "emergency-balanced";
				};
			};
		};
		
	};

	fixed-regulators {
		compatible = "simple-bus";
		device_type = "fixed-regulators";
		#address-cells = <1>;
		#size-cells = <0>;
		
		battery_reg: regulator@0 {
			compatible = "regulator-fixed";
			reg = <0>;
			regulator-name = "vdd-ac-bat";
			regulator-min-microvolt = <5000000>;
			regulator-max-microvolt = <5000000>;
			regulator-always-on;
		};
		
		usb1_reg: regulator@103 {
			compatible = "regulator-fixed";
			reg = <103>;
			regulator-name = "vdd-usb1-reg";
			regulator-min-microvolt = <5000000>;
			regulator-max-microvolt = <5000000>;
			gpio = <&tegra_main_gpio TEGRA194_MAIN_GPIO(A, 1) 0>;
			enable-active-high;
		};

		usb2_reg: regulator@104 {
			compatible = "regulator-fixed";
			reg = <104>;
			regulator-name = "vdd-usb2-reg";
			regulator-min-microvolt = <5000000>;
			regulator-max-microvolt = <5000000>;
			gpio = <&tegra_aon_gpio TEGRA194_AON_GPIO(AA, 6) 0>;
			enable-active-high;
		};

		usb3_reg: regulator@105 {
			compatible = "regulator-fixed";
			reg = <105>;
			regulator-name = "vdd-usb3-reg";
			regulator-min-microvolt = <5000000>;
			regulator-max-microvolt = <5000000>;
			gpio = <&tegra_aon_gpio TEGRA194_AON_GPIO(BB, 1) 0>;
			enable-active-high;
		};

		vdd_sdmmc1_sw: regulator@106 {
			compatible = "regulator-fixed";
			reg = <106>;
			regulator-name = "vdd-sdmmc1-sw";
			regulator-min-microvolt = <3300000>;
			regulator-max-microvolt = <3300000>;
			gpio = <&tegra_main_gpio TEGRA194_MAIN_GPIO(A, 0) 0>;
			enable-active-high;
		};

	};

/* USB-configure */
	xusb_padctl: xusb_padctl@3520000 {
		status = "okay";
		pex_dvdd-supply = <&p2888_spmic_sd0>;
		pex_hvdd-supply = <&p2888_spmic_sd1>;
		pex_pll_hvdd-supply = <&p2888_spmic_sd1>;
		vclamp_usb-supply = <&p2888_spmic_sd3>;
		avdd_usb-supply = <&p2888_spmic_ldo5>;
		avdd_pll_nvhs_eutmip-supply = <&p2888_spmic_sd1>;
		ports {
			usb2-0 {
				vbus-supply = <&usb1_reg>;
			};
			usb2-1 {
				vbus-supply = <&usb2_reg>;
			};
			usb2-2 {
				vbus-supply = <&usb3_reg>;
			};
		};
		
		pads {
			usb2 {
				lanes {
					usb2-0 {
						nvidia,function = "xusb";
						status = "okay";
					};
					usb2-1 {
						nvidia,function = "xusb";
						status = "okay";
					};
					usb2-2 {
						nvidia,function = "xusb";
						status = "okay";
					};
				};
			};
			usb3 {
				lanes {
					usb3-0 {
						nvidia,function = "xusb";
						status = "okay";
					};
					usb3-2 {
						nvidia,function = "xusb";
						status = "okay";
					};
					usb3-3 {
						nvidia,function = "xusb";
						status = "okay";
					};
				};
			};
		};

		ports {
			usb2-0 {
				mode = "host";
				status = "okay";
			};
			usb2-1 {
				mode = "host";
				status = "okay";
			};
			usb2-2 {
				mode = "host";
				status = "okay";
			};
			usb3-0 {
				nvidia,usb2-companion = <0>;
				status = "okay";
			};
			usb3-2 {
				nvidia,usb2-companion = <1>;
				status = "okay";
			};
			usb3-3 {
				nvidia,usb2-companion = <2>;
				status = "okay";
			};
		};
	};

	tegra_xhci: xhci@3610000 {
		extcon-cable-names = "id";
		#extcon-cells = <1>;
		phys = <&{/xusb_padctl@3520000/pads/usb2/lanes/usb2-0}>,
			<&{/xusb_padctl@3520000/pads/usb2/lanes/usb2-1}>,
			<&{/xusb_padctl@3520000/pads/usb2/lanes/usb2-2}>,
			<&{/xusb_padctl@3520000/pads/usb3/lanes/usb3-0}>,
			<&{/xusb_padctl@3520000/pads/usb3/lanes/usb3-2}>,
			<&{/xusb_padctl@3520000/pads/usb3/lanes/usb3-3}>;
		phy-names = "usb2-0", "usb2-1", "usb2-2",
			"usb3-0", "usb3-2", "usb3-3";
		nvidia,xusb-padctl = <&xusb_padctl>;
		status = "okay";
	};	
	
/* uart-configure */
	combined-uart {
		console-port;
		combined-uart;
		status = "okay";
	};
	
	serial@3100000 {
		compatible = "nvidia,tegra186-hsuart";
		status = "okay";
	};

	serial@3110000 {
		status = "okay";
	};

	serial@c280000 {
		status = "disabled";
	};

	serial@3130000 {
		status = "disabled";
	};

	serial@3140000 {
		compatible = "nvidia,tegra186-hsuart";
		status = "okay";
	};
	
	serial@3150000 {
		status = "disabled";
	};

	serial@c290000 {
		status = "disabled";
	};

	serial@3170000 {
		status = "disabled";
	};
	
	
/* i2c-configure */
	i2c@3160000 { /* I2C1 ID EEPROM */
		status = "okay";
	};

	i2c@c240000 { /* I2C2 */
		status = "okay";
		
		ina3221x_40: ina3221x@40 {
			compatible = "ti,ina3221x";
			reg = <0x40>;
			ti,trigger-config = <0x7003>;
			ti,continuous-config = <0x7c07>;
			ti,enable-forced-continuous;
			#address-cells = <1>;
			#size-cells = <0>;
			#io-channel-cells = <1>;
			channel@0 {
				reg = <0x0>;
				ti,rail-name = "GPU";
				ti,shunt-resistor-mohm = <5>;
				shunt-volt-offset-uv = <&p2888_shuntv_offset>;
			};
			channel@1 {
				reg = <0x1>;
				ti,rail-name = "CPU";
				ti,shunt-resistor-mohm = <5>;
				shunt-volt-offset-uv = <&p2888_shuntv_offset>;
			};
			channel@2 {
				reg = <0x2>;
				ti,rail-name = "SOC";
				ti,shunt-resistor-mohm = <5>;
				shunt-volt-offset-uv = <&p2888_shuntv_offset>;
			};
		};
		
		ina3221x_41: ina3221x@41 {
			compatible = "ti,ina3221x";
			reg = <0x41>;
			ti,trigger-config = <0x7003>;
			ti,continuous-config = <0x7c07>;
			ti,enable-forced-continuous;
			#address-cells = <1>;
			#size-cells = <0>;
			#io-channel-cells = <1>;
			channel@0 {
				reg = <0x0>;
				ti,rail-name = "CV";
				ti,shunt-resistor-mohm = <5>;
				shunt-volt-offset-uv = <&p2888_shuntv_offset>;
			};
			channel@1 {
				reg = <0x1>;
				ti,rail-name = "VDDRQ";
				ti,shunt-resistor-mohm = <5>;
				shunt-volt-offset-uv = <&p2888_shuntv_offset>;
			};
			channel@2 {
				reg = <0x2>;
				ti,rail-name = "SYS5V";
				ti,shunt-resistor-mohm = <5>;
				shunt-volt-offset-uv = <&p2888_shuntv_offset>;
			};
		};

	};

	i2c@3180000 { /* I2C3 EFM32 */
		status = "okay";
		clock-frequency = <100000>;
		
		efm32: rtx-efm32@0c {
			compatible = "rtx,efm32";
			reg = <0x0c>;
			/* gpio-mcux = <&tegra_main_gpio TEGRA194_MAIN_GPIO(Q, 0) 0>; */
			/* gpio-xmcu = <&tegra_main_gpio TEGRA194_MAIN_GPIO(R, 0) 0>; */
		};
	};

	i2c@3190000 { /* I2C4 */
		status = "disabled";
	};

	bpmp_i2c { /* I2C5 PMIC */
		status = "okay";
		p2888_spmic: spmic@3c {
			compatible = "maxim,max20024";
			reg = <0x3c>;

			interrupt-parent = <&tegra_pm_irq>;
			interrupts = <0 TEGRA194_IRQ_PMIC_EXT_INTR IRQ_TYPE_NONE>;

			#interrupt-cells = <2>;
            interrupt-controller;

			gpio-controller;
			#gpio-cells = <2>;

			enable-clock32k-out;

			system-pmic-power-off;
			avoid-power-off-commands;

			hot-die-threshold-temp = <110000>;
			#thermal-sensor-cells = <0>;

			pinctrl-names = "default";
			pinctrl-0 = <&spmic_default>;

			spmic_default: pinmux@0 {
				pin_gpio0 {
					pins = "gpio0";
					function = "gpio";
				};

				pin_gpio1 {
					pins = "gpio1";
					function = "fps-out";
					active-fps-source = <MAX77620_FPS_SRC_DEF>;
				};

				pin_gpio2 {
					pins = "gpio2";
					function = "fps-out";
					active-fps-source = <MAX77620_FPS_SRC_DEF>;
				};

				pin_gpio3 {
					pins = "gpio3";
					function = "fps-out";
					active-fps-source = <MAX77620_FPS_SRC_DEF>;
				};

				pin_gpio4 {
					pins = "gpio4";
					function = "32k-out1";
					drive-push-pull = <1>;
				};

				pin_gpio6 {
					pins = "gpio6";
					function = "gpio";
					drive-push-pull = <1>;
				};

				pin_gpio7 {
					pins = "gpio7";
					function = "gpio";
					drive-push-pull = <0>;
				};
			};

			gpio_default {
				gpio-hog;
				output-high;
				gpios = <6 0 7 0>;
				label = "spmic-gpio6", "spmic-gpio7";
			};

			p2888_spmic_wdt: watchdog {
				wdt-boot-timeout = <32>;
				wdt-suspend-timeout = <120>;
				status = "disabled";
			};

			fps {
				#address-cells = <1>;
				#size-cells = <0>;

				fps0 {
					reg = <0>;
					fps-event-source = <MAX77620_FPS_EVENT_SRC_EN0>;
				};

				fps1 {
					reg = <1>;
					fps-event-source = <MAX77620_FPS_EVENT_SRC_EN1>;
					device-state-on-disabled-event = <MAX77620_FPS_INACTIVE_STATE_SLEEP>;
				};

				fps2 {
					reg = <2>;
					fps-event-source = <MAX77620_FPS_EVENT_SRC_EN0>;
				};
			};

			backup-battery {
				backup-battery-charging-current = <100>;
				backup-battery-charging-voltage = <3000000>;
				backup-battery-output-resister = <100>;
				status = "disabled";
			};

			regulators {
				in-ldo7-8-supply = <&p2888_spmic_sd2>;

				p2888_spmic_sd0: sd0 {
					regulator-name = "vdd-1v0";
					regulator-always-on;
					regulator-boot-on;
					regulator-init-mode = <REGULATOR_MODE_NORMAL>;
					active-fps-source = <MAX77620_FPS_SRC_DEF>;
					regulator-enable-ramp-delay = <3960>;
					regulator-disable-ramp-delay = <660>;
					ramp-rate-setting = <27500>;
					regulator-ramp-delay = <1100>;
				};

				p2888_spmic_sd1: sd1 {
					regulator-name = "vdd-1v8-hs";
					regulator-always-on;
					regulator-boot-on;
					regulator-init-mode = <REGULATOR_MODE_NORMAL>;
					active-fps-source = <MAX77620_FPS_SRC_DEF>;
					regulator-enable-ramp-delay = <3310>;
					regulator-disable-ramp-delay = <2000>;
					ramp-rate-setting = <27500>;
					regulator-ramp-delay = <550>;
				};

				p2888_spmic_sd2: sd2 {
					regulator-name = "vdd-1v8-ls";
					regulator-always-on;
					regulator-boot-on;
					regulator-init-mode = <REGULATOR_MODE_NORMAL>;
					active-fps-source = <MAX77620_FPS_SRC_DEF>;
					regulator-enable-ramp-delay = <3310>;
					regulator-disable-ramp-delay = <1970>;
					ramp-rate-setting = <27500>;
					regulator-ramp-delay = <550>;
				};

				p2888_spmic_sd3: sd3 {
					regulator-name = "vdd-1v8-ao";
					regulator-always-on;
					regulator-boot-on;
					regulator-init-mode = <REGULATOR_MODE_NORMAL>;
					active-fps-source = <MAX77620_FPS_SRC_DEF>;
					regulator-enable-ramp-delay = <2130>;
					regulator-disable-ramp-delay = <1970>;
					ramp-rate-setting = <27500>;
					regulator-ramp-delay = <350>;
				};

				p2888_spmic_sd4: sd4 {
					regulator-name = "vddio-ddr-1v1";
					regulator-always-on;
					regulator-boot-on;
					regulator-init-mode = <REGULATOR_MODE_NORMAL>;
					active-fps-source = <MAX77620_FPS_SRC_DEF>;
					regulator-enable-ramp-delay = <2650>;
					regulator-disable-ramp-delay = <1300>;
					ramp-rate-setting = <27500>;
					regulator-ramp-delay = <700>;
				};

				p2888_spmic_ldo0: ldo0 {
					regulator-name = "vdd-rtc";
					regulator-always-on;
					regulator-boot-on;
					active-fps-source = <MAX77620_FPS_SRC_DEF>;
					regulator-enable-ramp-delay = <160>;
					regulator-disable-ramp-delay = <4480>;
					ramp-rate-setting = <100000>;
					regulator-ramp-delay = <200>;
				};

				p2888_spmic_ldo1: ldo1 {
					regulator-name = "spmic-ldo1";
					active-fps-source = <MAX77620_FPS_SRC_DEF>;
					regulator-enable-ramp-delay = <2650>;
					regulator-disable-ramp-delay = <1300>;
					ramp-rate-setting = <100000>;
					regulator-ramp-delay = <1150>;
				};

				p2888_spmic_ldo2: ldo2 {
					regulator-name = "vdd-ao-3v3";
					regulator-always-on;
					regulator-boot-on;
					active-fps-source = <MAX77620_FPS_SRC_DEF>;
					regulator-enable-ramp-delay = <4670>;
					ramp-rate-setting = <100000>;
					regulator-ramp-delay = <1500>;
				};

				p2888_spmic_ldo3: ldo3 {
					regulator-name = "vddio-emmc-3v3";
					regulator-always-on;
					regulator-boot-on;
					active-fps-source = <MAX77620_FPS_SRC_DEF>;
					regulator-enable-ramp-delay = <4670>;
					ramp-rate-setting = <100000>;
					regulator-ramp-delay = <1500>;
				};

				p2888_spmic_ldo4: ldo4 {
					regulator-name = "spmic-ldo4";
					active-fps-source = <MAX77620_FPS_SRC_DEF>;
					regulator-enable-ramp-delay = <3310>;
					regulator-disable-ramp-delay = <1970>;
					ramp-rate-setting = <100000>;
					regulator-ramp-delay = <2200>;
				};

				p2888_spmic_ldo5: ldo5 {
					regulator-name = "vdd-usb-3v3";
					regulator-always-on;
					regulator-boot-on;
					active-fps-source = <MAX77620_FPS_SRC_DEF>;
					regulator-enable-ramp-delay = <4670>;
					ramp-rate-setting = <100000>;
					regulator-ramp-delay = <1500>;
				};

				p2888_spmic_ldo6: ldo6 {
					regulator-name = "vddio-sdmmc1-3v3";
					regulator-always-on;
					regulator-boot-on;
					active-fps-source = <MAX77620_FPS_SRC_DEF>;
					regulator-enable-ramp-delay = <4690>;
					ramp-rate-setting = <100000>;
					regulator-ramp-delay = <1500>;
				};

				p2888_spmic_ldo7: ldo7 {
					regulator-name = "vdd-csi-1v2";
					regulator-always-on;
					regulator-boot-on;
					active-fps-source = <MAX77620_FPS_SRC_DEF>;
					regulator-enable-ramp-delay = <3960>;
					regulator-disable-ramp-delay = <660>;
					ramp-rate-setting = <100000>;
					regulator-ramp-delay = <3350>;
				};

				p2888_spmic_ldo8: ldo8 {
					regulator-name = "spmic-ldo8";
					active-fps-source = <MAX77620_FPS_SRC_DEF>;
					regulator-enable-ramp-delay = <3960>;
					regulator-disable-ramp-delay = <660>;
					ramp-rate-setting = <100000>;
					regulator-ramp-delay = <2250>;
				};
				
			};
		};

		tegra_tmp451: temp-sensor@4c {
			status = "okay";
			#thermal-sensor-cells = <1>;
			compatible = "ti,tmp451";
			reg = <0x4c>;
			sensor-name = "tmp451-ext";
			supported-hwrev = <1>;
			offset = <(-38)>;
			conv-rate = <0x06>;
			extended-rage = <1>;

			interrupt-parent = <&tegra_main_gpio>;
			interrupts = <TEMP_ALERT IRQ_TYPE_LEVEL_LOW>;
			temp-alert-gpio = <&tegra_main_gpio TEMP_ALERT 0>;

			/* vdd-supply configured in power tree */

			loc {
				/* set to maximum for not having local  shutdown */
				shutdown-limit = <107>;
			};
			ext {
				shutdown-limit = <109>;
			};
		};
	};

	i2c@31b0000 { /* I2C6 */
		status = "disabled";
	};

	i2c@31c0000 { /* I2C7 */
		status = "disabled";
	};

	i2c@c250000 { /* I2C8 */
		status = "disabled";
	};

	i2c@31e0000 { /* I2C9 */
		status = "disabled";
	};
	
/* spi-configure */
	spi@3210000 {
		status = "disabled";
	};

	spi@c260000 {
		status = "disabled";
	};

	spi@3230000 {
		status = "disabled";
	};

	spi@3270000 {
		status = "disabled";
	};

	spi@3300000 {
		status = "disabled";
	};

/* can-configure */
    mttcan@c310000 {
	 status = "disabled";
    };

    mttcan@c320000 {
		status = "disabled";
    };
	
/* pwm-configure */
	pwm@3280000 {
		status = "disabled";
	};

	pwm@3290000 {
		status = "disabled";
	};

	pwm@32a0000 {
		status = "disabled";
	};

	pwm@c340000 {
		status = "disabled";
	};

	pwm@32c0000 {
		status = "disabled";
	};

	pwm@32d0000 {
		status = "disabled";
	};

	pwm@32e0000 {
		status = "disabled";
	};

	pwm@32f0000 {
		status = "disabled";
	};
	
	tachometer@39c0000 {
		status = "disabled";
	};
	
	generic_pwm_tachometer  {
		status = "disabled";
	};
	
/* sdhc-configure */
	sdhci@3400000 {
		vmmc-supply = <&vdd_sdmmc1_sw>;
		mmc-ocr-mask = <0x0>;
		cd-gpios = <&tegra_main_gpio TEGRA194_MAIN_GPIO(G, 7) 0>;
		nvidia,cd-wakeup-capable;
		nvidia,vmmc-always-on;
		status = "okay";
	};

	sdhci@3460000 {
		status = "disabled";
	};

	sdhci@3460000 {
		vmmc-supply = <&p2888_spmic_ldo3>;
		vqmmc-supply = <&p2888_spmic_sd2>;
		uhs-mask = <0x0>;
		nvidia,enable-hwcq;
		status = "okay";
	};

/* gpio-configure */
	gpio-keys {
		compatible = "gpio-keys";
		gpio-keys,name = "gpio-keys";

		forcerecovery {
			label = "force-recovery";
			gpios = <&tegra_main_gpio TEGRA194_MAIN_GPIO(G, 0) GPIO_ACTIVE_LOW>;
			linux,code = <BTN_1>;
		};

		power_key {
			label = "power-key";
			gpios = <&tegra_aon_gpio TEGRA194_AON_GPIO(EE, 4) GPIO_ACTIVE_LOW>;
			linux,code = <KEY_POWER>;
			gpio-key,wakeup;
		};
	};

/* pcie-configure */
	pcie_ep@14180000 { /* Controller 0 EndPoint */
		status = "disabled";
	};
	
	pcie_ep@14160000 { /* Controller 4 EndPoint */
		status = "disabled";
	};

	pcie_ep@141a0000 { /* Controller 5 EndPoint */
		status = "disabled";
		
		vddio-pex-ctl-supply = <&p2888_spmic_sd3>;
		nvidia,disable-aspm-states = <0xf>;

		phys = <&p2u_12>, <&p2u_13>, <&p2u_14>, <&p2u_15>,
			   <&p2u_16>, <&p2u_17>, <&p2u_18>, <&p2u_19>;
		phy-names = "pcie-p2u-0", "pcie-p2u-1", "pcie-p2u-2", "pcie-p2u-3",
					"pcie-p2u-4", "pcie-p2u-5", "pcie-p2u-6", "pcie-p2u-7";

		nvidia,pex-rst-gpio = <&tegra_main_gpio TEGRA194_MAIN_GPIO(GG, 1) GPIO_ACTIVE_LOW>;
	};

	pcie@14180000 { /* Controller 0 Root; KIT uphy2~5 for M.2 Key M */
		status = "disabled";

		vddio-pex-ctl-supply = <&p2888_spmic_sd3>;
		nvidia,disable-aspm-states = <0xf>;
		nvidia,enable-power-down;
		nvidia,disable-clock-request;

		phys = <&p2u_2>, <&p2u_3>, <&p2u_4>, <&p2u_5>;
		phy-names = "pcie-p2u-0", "pcie-p2u-1", "pcie-p2u-2", "pcie-p2u-3";
	};

	pcie@14100000 { /* Controller 1 Root; KIT uphy0 for eSATA */
		status = "okay";

		vddio-pex-ctl-supply = <&p2888_spmic_sd3>;
		nvidia,disable-aspm-states = <0xc>;
		nvidia,enable-power-down;
		nvidia,disable-clock-request;

		phys = <&p2u_0>;
		phy-names = "pcie-p2u-0";
		
		nvidia,max-speed = <2>;
	};
	
	pcie@14120000 { /* Controller 2 Root; KIT NA */
		status = "disabled";
	};

	pcie@14140000 { /* Controller 3 Root; KIT uphy7 for M.2 Key E */
		status = "okay";
		
		vddio-pex-ctl-supply = <&p2888_spmic_sd3>;
		nvidia,disable-aspm-states = <0xf>;
		nvidia,enable-power-down;
		nvidia,disable-clock-request;

		phys = <&p2u_7>;
		phy-names = "pcie-p2u-0";

		nvidia,pex-wake = <&tegra_main_gpio TEGRA194_MAIN_GPIO(L, 2) GPIO_ACTIVE_HIGH>;

	};

	pcie@14160000 { /* Controller 4 Root; KIT uphy8~9 unused */
		status = "disabled";
	};

	pcie@141a0000 { /* Controller 5 Root; KIT nvhs-uphy12~19 for PCIe*16 */
		status = "disabled";
		
		vddio-pex-ctl-supply = <&p2888_spmic_sd3>;
		nvidia,disable-aspm-states = <0xf>;
		nvidia,enable-power-down;
		nvidia,disable-clock-request;

		phys = <&p2u_12>, <&p2u_13>, <&p2u_14>, <&p2u_15>,
			   <&p2u_16>, <&p2u_17>, <&p2u_18>, <&p2u_19>;
		phy-names = "pcie-p2u-0", "pcie-p2u-1", "pcie-p2u-2", "pcie-p2u-3",
					"pcie-p2u-4", "pcie-p2u-5", "pcie-p2u-6", "pcie-p2u-7";

		nvidia,plat-gpios =
			<&tegra_main_gpio TEGRA194_MAIN_GPIO(Z, 2) GPIO_ACTIVE_HIGH    /* 3V3 */
			 &tegra_main_gpio TEGRA194_MAIN_GPIO(A, 1) GPIO_ACTIVE_LOW     /* 12V */
		     /*&tegra_main_gpio TEGRA194_MAIN_GPIO(Y, 4) GPIO_ACTIVE_HIGH */ /* I2C */
			>;
	};

/* net-configure */
    ether_qos@2490000 {
		status = "okay";
		vddio_sys_enet_bias-supply = <&battery_reg>;
		vddio_enet-supply = <&battery_reg>;
		phy_vdd_1v8-supply = <&p2888_spmic_sd2>;
		phy_ovdd_rgmii-supply = <&p2888_spmic_sd2>;
		phy_pllvdd-supply = <&battery_reg>;
		
		/* PTP_ref clock speed in MHz */
		nvidia,ptp_ref_clock_speed = <312500000>;
		/* rxq_enable_ctrl = <rx0 rx1 rx2 rx3>
		 * 0x0 = Not enabled, 0x1 = Enabled for AV
		 * 0x2 = Enabled for Legacy, 0x3 = Reserved
		 */
		nvidia,rxq_enable_ctrl = <2 2 2 2>;
		nvidia,queue_prio = <0 1 2 3>;

		nvidia,use_tagged_ptp;
		nvidia,ptp_dma_ch = <3>;

		nvidia,chan_napi_quota = <64 64 64 64>;
		nvidia,pause_frames = <0>; /*0=enable, 1=disable */
		nvidia,phy-reset-gpio = <&tegra_main_gpio TEGRA194_MAIN_GPIO(G, 5) 0>;
		nvidia,phy-reset-post-delay = <224>;
		nvidia,phy-reset-duration = <10000>;
		nvidia,phy-max-frame-size = <16>;	/* size in kbytes */
		nvidia,eth_iso_enable = <1>; /*0=enable, 1=disable */
		phy-mode = "rgmii-id";
		phy-handle = <&phy1>;

		mdio {
			compatible = "nvidia,eqos-mdio";
			#address-cells = <1>;
			#size-cells = <0>;

			phy1: ethernet-phy@1 {
				reg = <1>;
				interrupt-parent = <&tegra_main_gpio>;
				interrupts = <TEGRA194_MAIN_GPIO(G, 4) IRQ_TYPE_LEVEL_LOW>;
				marvell,copper-mode;
				/* Setup LED[2] as interrupt pin (active low) */
				marvell,reg-init = <0x03 0x12 0x7fff 0x880>;
			};
		};
	};
	
};



